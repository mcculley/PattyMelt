This was originally developed by Gene McCulley <mcculley@stackframe.com> as a
straightforward port of Brian Swetland's C implementation.

Dirk Harrington (https://github.com/dirkharrington) contributed various fixes and improvements.
